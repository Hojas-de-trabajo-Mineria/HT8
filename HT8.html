<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HT8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HT8_files/libs/clipboard/clipboard.min.js"></script>
<script src="HT8_files/libs/quarto-html/quarto.js"></script>
<script src="HT8_files/libs/quarto-html/popper.min.js"></script>
<script src="HT8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HT8_files/libs/quarto-html/anchor.min.js"></script>
<link href="HT8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HT8_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HT8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HT8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HT8_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HT8</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="hoja-de-trabajo-8" class="level1">
<h1>Hoja de trabajo 8</h1>
<section id="modificación-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="modificación-de-datos">Modificación de datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(pricesTrain))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Id    MSSubClass      MSZoning   LotFrontage       LotArea 
            0             0             0           259             0 
       Street         Alley      LotShape   LandContour     Utilities 
            0          1369             0             0             0 
    LotConfig     LandSlope  Neighborhood    Condition1    Condition2 
            0             0             0             0             0 
     BldgType    HouseStyle   OverallQual   OverallCond     YearBuilt 
            0             0             0             0             0 
 YearRemodAdd     RoofStyle      RoofMatl   Exterior1st   Exterior2nd 
            0             0             0             0             0 
   MasVnrType    MasVnrArea     ExterQual     ExterCond    Foundation 
            8             8             0             0             0 
     BsmtQual      BsmtCond  BsmtExposure  BsmtFinType1    BsmtFinSF1 
           37            37            38            37             0 
 BsmtFinType2    BsmtFinSF2     BsmtUnfSF   TotalBsmtSF       Heating 
           38             0             0             0             0 
    HeatingQC    CentralAir    Electrical     X1stFlrSF     X2ndFlrSF 
            0             0             1             0             0 
 LowQualFinSF     GrLivArea  BsmtFullBath  BsmtHalfBath      FullBath 
            0             0             0             0             0 
     HalfBath  BedroomAbvGr  KitchenAbvGr   KitchenQual  TotRmsAbvGrd 
            0             0             0             0             0 
   Functional    Fireplaces   FireplaceQu    GarageType   GarageYrBlt 
            0             0           690            81            81 
 GarageFinish    GarageCars    GarageArea    GarageQual    GarageCond 
           81             0             0            81            81 
   PavedDrive    WoodDeckSF   OpenPorchSF EnclosedPorch    X3SsnPorch 
            0             0             0             0             0 
  ScreenPorch      PoolArea        PoolQC         Fence   MiscFeature 
            0             0          1453          1179          1406 
      MiscVal        MoSold        YrSold      SaleType SaleCondition 
            0             0             0             0             0 
    SalePrice 
            0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> pricesTrain[<span class="fu">order</span>(pricesTrain<span class="sc">$</span>SalePrice),]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>orderPrice[<span class="st">'Clasificacion'</span>]<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(orderPrice))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Id, MoSold, YrSold, GarageYrBlt, Alley, LotShape, LandContour, Condition2, YearBuilt, Exterior2nd, FireplaceQu, GarageQual, SaleType,BsmtFinType2, BsmtFinSF2, BsmtUnfSF, BsmtFullBath, BsmtHalfBath, X3SsnPorch, GarageFinish, YearRemodAdd, PoolQC, Fence, MiscFeature))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span> (<span class="fu">c</span>(<span class="st">"MSSubClass"</span>,<span class="st">"MSZoning"</span>, <span class="st">"Utilities"</span>, <span class="st">"LotConfig"</span>, <span class="st">"Street"</span>, <span class="st">"LandSlope"</span>, <span class="st">"Neighborhood"</span>, <span class="st">"Condition1"</span>, <span class="st">"BldgType"</span>, <span class="st">"HouseStyle"</span>, <span class="st">"OverallQual"</span>, <span class="st">"OverallCond"</span>, <span class="st">"RoofStyle"</span>, <span class="st">"PavedDrive"</span>, <span class="st">"RoofMatl"</span>, <span class="st">"Exterior1st"</span>, <span class="st">"MasVnrType"</span>, <span class="st">"ExterQual"</span>, <span class="st">"ExterCond"</span>,<span class="st">"Foundation"</span>, <span class="st">"BsmtQual"</span>, <span class="st">"BsmtCond"</span>, <span class="st">"BsmtExposure"</span>, <span class="st">"BsmtFinType1"</span>, <span class="st">"Heating"</span>, <span class="st">"HeatingQC"</span>, <span class="st">"CentralAir"</span>,<span class="st">"Electrical"</span>, <span class="st">"Functional"</span>, <span class="st">"GarageType"</span>, <span class="st">"GarageCond"</span>, <span class="st">"SaleCondition"</span>, <span class="st">"KitchenQual"</span>), as.factor)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>), as.numeric)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">139000</span>] <span class="ot">&lt;-</span> <span class="st">'Economica'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">139000</span> <span class="sc">&amp;</span> orderPrice<span class="sc">$</span>SalePrice <span class="sc">&lt;=</span> <span class="dv">189893</span> ] <span class="ot">&lt;-</span> <span class="st">'Intermedia'</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>orderPrice<span class="sc">$</span>Clasificacion[orderPrice<span class="sc">$</span>SalePrice <span class="sc">&gt;</span> <span class="dv">189893</span>] <span class="ot">&lt;-</span> <span class="st">'Cara'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>), scale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fueron retiradas las variables que no tienen relación con la variable respuesta, así como aquellas con altas cantidades de NA’s. Todas las variables categóricas fueron convertidas en factores y las numéricas fueron normalizadas. Además, fue agregada una variable categórica que representa el rango de precio en el que se encuentra cada una de las casas, esta es nuestra variable de interés.</p>
</section>
<section id="muestreo" class="level2">
<h2 class="anchored" data-anchor-id="muestreo">Muestreo</h2>
<p>Muestreo estratificado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COnvertir en factores</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>orderPrice <span class="ot">&lt;-</span> orderPrice<span class="sc">%&gt;%</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Clasificacion"</span>),as.factor)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>economicas <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Economica'</span>,]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>intermedias <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Intermedia'</span>,]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>caras <span class="ot">&lt;-</span> orderPrice[orderPrice<span class="sc">$</span>Clasificacion <span class="sc">==</span> <span class="st">'Cara'</span>,]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>filasCasasE <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(economicas), <span class="fu">nrow</span>(economicas)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>filasCasasI <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(intermedias), <span class="fu">nrow</span>(intermedias)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>filasCasasC <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(caras), <span class="fu">nrow</span>(caras)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[filasCasasE,], intermedias[filasCasasI,], caras[filasCasasC,])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">rbind</span>(economicas[<span class="sc">-</span>filasCasasE,], intermedias[<span class="sc">-</span>filasCasasI,], caras[<span class="sc">-</span>filasCasasC,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelos-de-clasificación" class="level2">
<h2 class="anchored" data-anchor-id="modelos-de-clasificación">Modelos de clasificación</h2>
<section id="modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="modelo-1">Modelo 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>testClas <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(test)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> testClas[,<span class="st">"Clasificacion"</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>testClas <span class="ot">&lt;-</span> testClas<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"SalePrice"</span>, <span class="st">"Clasificacion"</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>trainClas <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"SalePrice"</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">nnet</span>(Clasificacion<span class="sc">~</span>.,<span class="at">data =</span> trainClas, <span class="at">size=</span><span class="dv">4</span>, <span class="at">rang=</span><span class="fl">0.1</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">decay=</span><span class="fl">5e-4</span>, <span class="at">maxit=</span><span class="dv">200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  771
initial  value 837.234487 
iter  10 value 432.330265
iter  20 value 309.359527
iter  30 value 258.334132
iter  40 value 227.191584
iter  50 value 213.333063
iter  60 value 204.523819
iter  70 value 189.353591
iter  80 value 184.005720
iter  90 value 178.002448
iter 100 value 175.332675
iter 110 value 173.506928
iter 120 value 172.409292
iter 130 value 166.978168
iter 140 value 164.239213
iter 150 value 161.432759
iter 160 value 158.685599
iter 170 value 152.661486
iter 180 value 143.918544
iter 190 value 136.950068
iter 200 value 131.066653
final  value 131.066653 
stopped after 200 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>prediccion1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(modelo1, <span class="at">newdata =</span> testClas))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>columnaMasAlta<span class="ot">&lt;-</span><span class="fu">apply</span>(prediccion1, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">colnames</span>(prediccion1)[<span class="fu">which.max</span>(x)])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>columnaMasAlta <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">unlist</span>(columnaMasAlta))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(columnaMasAlta,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        107         0         19
  Economica     0        92         23
  Intermedia   12        11         70

Overall Statistics
                                          
               Accuracy : 0.8054          
                 95% CI : (0.7588, 0.8465)
    No Information Rate : 0.3563          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7078          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.8992           0.8932            0.6250
Specificity               0.9116           0.9004            0.8964
Pos Pred Value            0.8492           0.8000            0.7527
Neg Pred Value            0.9423           0.9498            0.8257
Prevalence                0.3563           0.3084            0.3353
Detection Rate            0.3204           0.2754            0.2096
Detection Prevalence      0.3772           0.3443            0.2784
Balanced Accuracy         0.9054           0.8968            0.7607</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gr[afica predicción 1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(columnaMasAlta , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT8_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Veamos que utilizando la red generada por la librería nnet, con 4 neuronas en su capa oculta, nos proporciona un accuracy del <span class="math inline">\(80.54\%\)</span>. Vemos que parece ser que el modelo tiene un ligero underfitting, ya que clasifica varias de las casas “intermedias” que en realidad son de otro valor. Esto tiene sentido ya que el valor intermedio es el que se encuentra entre los otros dos</p>
</section>
<section id="modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="modelo-2">Modelo 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>trainClas <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(trainClas)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Clasificacion<span class="sc">~</span>.,<span class="at">data =</span> trainClas, <span class="at">method=</span><span class="st">"nnet"</span>, <span class="at">trace=</span>F)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>prediccion2<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(modelo2, <span class="at">newdata =</span> testClas))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>prediccion2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">unlist</span>(prediccion2))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion2,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Cara Economica Intermedia
  Cara        108         0         17
  Economica     0        89         22
  Intermedia   11        14         73

Overall Statistics
                                         
               Accuracy : 0.8084         
                 95% CI : (0.762, 0.8492)
    No Information Rate : 0.3563         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7122         
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: Cara Class: Economica Class: Intermedia
Sensitivity               0.9076           0.8641            0.6518
Specificity               0.9209           0.9048            0.8874
Pos Pred Value            0.8640           0.8018            0.7449
Neg Pred Value            0.9474           0.9372            0.8347
Prevalence                0.3563           0.3084            0.3353
Detection Rate            0.3234           0.2665            0.2186
Detection Prevalence      0.3743           0.3323            0.2934
Balanced Accuracy         0.9142           0.8844            0.7696</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prediccion2 , <span class="at">col=</span><span class="st">"green"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">135</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">density=</span><span class="dv">20</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Predicción del modelo"</span>,<span class="st">"Datos reales"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">fill=</span><span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT8_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HT8_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Veamos que utilizando la red generada por la librería nnet, con 4 neuronas en su capa oculta, nos proporciona un accuracy del <span class="math inline">\(82.93\%\)</span>. Vemos que parece ser que el modelo tiene un ligero underfitting, ya que clasifica varias de las casas “intermedias” que en realidad son de otro valor. Esto tiene sentido ya que el valor intermedio es el que se encuentra entre los otros dos</p>
</section>
</section>
<section id="modelos-de-regresión" class="level2">
<h2 class="anchored" data-anchor-id="modelos-de-regresión">Modelos de regresión</h2>
<section id="modelo-1-1" class="level3">
<h3 class="anchored" data-anchor-id="modelo-1-1">Modelo 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>train_n <span class="ot">&lt;-</span> train[, <span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>)]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>test_n <span class="ot">&lt;-</span> test[, <span class="fu">c</span>(<span class="st">'MasVnrArea'</span>, <span class="st">'LotFrontage'</span>, <span class="st">'LotArea'</span>, <span class="st">'OverallQual'</span>, <span class="st">'OverallCond'</span>, <span class="st">'BsmtFinSF1'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'X1stFlrSF'</span>, <span class="st">'X2ndFlrSF'</span>, <span class="st">'LowQualFinSF'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'BedroomAbvGr'</span>, <span class="st">'KitchenAbvGr'</span>, <span class="st">'TotRmsAbvGrd'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'GarageCars'</span>, <span class="st">'GarageArea'</span>, <span class="st">'WoodDeckSF'</span>, <span class="st">'OpenPorchSF'</span>, <span class="st">'EnclosedPorch'</span>, <span class="st">'ScreenPorch'</span>, <span class="st">'PoolArea'</span>, <span class="st">'MiscVal'</span>, <span class="st">'SalePrice'</span>)]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>rm1 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(SalePrice<span class="sc">~</span>., <span class="at">data =</span> <span class="fu">na.omit</span>(train_n), <span class="at">hidden =</span> <span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">3</span>, <span class="at">act.fct =</span> sp, <span class="at">threshold =</span> <span class="fl">0.2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>pred_rm1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rm1, <span class="at">newdata =</span> test_n[, <span class="sc">-</span><span class="dv">26</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelo-2-1" class="level3">
<h3 class="anchored" data-anchor-id="modelo-2-1">Modelo 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sgm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rm2 <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(SalePrice<span class="sc">~</span>., <span class="at">data =</span> <span class="fu">na.omit</span>(train_n), <span class="at">hidden =</span> <span class="dv">3</span>, <span class="at">rep =</span> <span class="dv">3</span>, <span class="at">act.fct =</span> sgm, <span class="at">threshold =</span> <span class="fl">0.2</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>pred_rm2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rm2, <span class="at">newdata =</span> test_n[, <span class="sc">-</span><span class="dv">26</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="comparación-de-los-modelos-de-regresión" class="level2">
<h2 class="anchored" data-anchor-id="comparación-de-los-modelos-de-regresión">Comparación de los modelos de regresión</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>rmse_m1 <span class="ot">&lt;-</span> (<span class="fu">sum</span>((<span class="fu">na.omit</span>(pred_rm1 <span class="sc">-</span> test_n[, <span class="st">"SalePrice"</span>])<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">length</span>(pred_rm1))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>rmse_m2 <span class="ot">&lt;-</span> (<span class="fu">sum</span>((<span class="fu">na.omit</span>(pred_rm2 <span class="sc">-</span> test_n[, <span class="st">"SalePrice"</span>])<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> <span class="fu">length</span>(pred_rm2))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>rmse_m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6079542</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rmse_m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5559917</code></pre>
</div>
</div>
<p>Al comparar los RMSE de ambos modelos podemos ver que el modelo 2 predice de mejor manera el comportamiento, por lo tanto, de ahora en adelante se trabajará utlilizando dicho modelo.</p>
</section>
<section id="comparación-con-otros-algoritmos" class="level2">
<h2 class="anchored" data-anchor-id="comparación-con-otros-algoritmos">Comparación con otros algoritmos</h2>
<section id="clasificación" class="level3">
<h3 class="anchored" data-anchor-id="clasificación">Clasificación</h3>
<p>Veamos que en este caso, nuestro modelo 2 es igual ed bueno que nuestro “mejor modelo” anterior, que es el árbol realizado con RandomForest. Vemos que ambos nos dan alrededor de 82% de accuracy, por lo que podemos decir, que es comparativamente mejor que el resto de modelos que no incluye árboles de decisión</p>
</section>
<section id="regresión" class="level3">
<h3 class="anchored" data-anchor-id="regresión">Regresión</h3>
<p>Veamos que el mejor modelo de regresión que teníamos anteriormente era el NaiveBayes, con un error del 18%. Veamos que este modelo es comparatuvamente peor, ya que el mejor de los dos tiene un error del 55%, lo cual es bastante mayor que el de NaiveBayes. Sin embargo, podemos ver que es mejor que el modelo lineal planteado, ya que este tenía alrededor de 80% de error</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>